CREATE OR REPLACE STREAM "INMET_DATA_RETRIEVED" ( 
    "HR_MEDICAO"  INTEGER,
    "TEM_MAX"  REAL,
    "TEMP_INS"  REAL,
    "UMD_MIN"  REAL,
    "UMD_INS"  REAL,
    "RAD_GLO"  REAL
   );

CREATE OR REPLACE PUMP "INMET_DATA_PUMP"
AS INSERT INTO "INMET_DATA_RETRIEVED"
SELECT STREAM MAX(HR_MEDICAO), MAX(TEM_MAX), AVG(TEMP_INS), MIN(UMD_MIN), AVG(UMD_INS), SUM(RAD_GLO)
FROM "SOURCE_SQL_STREAM_001"
GROUP BY HR_MEDICAO,STEP("SOURCE_SQL_STREAM_001".ROWTIME BY INTERVAL '20' MINUTE);

CREATE OR REPLACE STERAM "STREAM_SEND_FORMAT" (
    "DATA" VARCHAR(20),
    "CD_ESTAÇÃO" VARCHAR(4),
    "DC_NOME" VARCHAR(16),
    "DATA_VALUE" REAL,
    "LATITUDE" VARCHAR(16),
    "LONGITUDE" VARCHAR(16),
    "HR_MEDICAO" INTEGER
);

CREATE OR REPLACE PUMP "DATA_TYPE_1" AS INSERT INTO "STREAM_SEND_FORMAT"
SELECT STREAM "TEM_MAX" AS DATA_TYPE, CD_ESTAÇÃO, DC_NOME, TEM_MAX, LATITUDE, LONGITUDE, SQS.SOURCE_SQL_STREAM_001 AS SQS
JOIN "INMET_DATA_RETRIEVED" AS IDR
ON SQS.TEM_MAX = IDR.TEM_MAX